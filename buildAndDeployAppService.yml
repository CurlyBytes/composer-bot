parameters:
- name: resourceGroupServiceConnection
  type: string
  default: ''
- name: appServiceResourceName
  type: string
  default: ''

steps:
- task: NuGetCommand@2
  displayName: 'Restore Bot'
  inputs:
    command: 'custom'
    arguments: 'restore Build/azurewebapp/Microsoft.BotFramework.Composer.WebApp.csproj -recursive'
- task: VSBuild@1
  displayName: Build Bot
  inputs:
    solution: Build/azurewebapp/Microsoft.BotFramework.Composer.WebApp.csproj
    vsVersion: "16.0"
    msbuildArgs: >-
      /p:DeployOnBuild=true /p:WebPublishMethod=Package
      /p:PackageLocation="$(Build.ArtifactStagingDirectory)"
    configuration: Release
- task: AzureRmWebAppDeployment@4
  displayName: Deploy Bot
  inputs:
    ConnectionType: 'AzureRM'
    azureSubscription: '${{parameters.resourceGroupServiceConnection}}'
    appType: 'webApp'
    WebAppName: '${{parameters.appServiceResourceName}}'
    packageForLinux: '$(Build.ArtifactStagingDirectory)/**/*.zip'